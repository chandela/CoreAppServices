/*
Deployment script for QuickMart

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "QuickMart"
:setvar DefaultFilePrefix "QuickMart"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
/*
The type for column ZipCode in table [dbo].[Address] is currently  NVARCHAR (20) NOT NULL but is being changed to  BIGINT NOT NULL. Data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[Address])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
/*
The column [dbo].[User].[DateOfBirth] is being dropped, data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[User])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
PRINT N'Altering [dbo].[Address]...';


GO
ALTER TABLE [dbo].[Address] ALTER COLUMN [ZipCode] BIGINT NOT NULL;


GO
PRINT N'Altering [dbo].[User]...';


GO
ALTER TABLE [dbo].[User] DROP COLUMN [DateOfBirth];


GO
ALTER TABLE [dbo].[User] ALTER COLUMN [Gender] NVARCHAR (75) NULL;


GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/

SET IDENTITY_INSERT [dbo].Address ON
INSERT INTO [dbo].[Address]
           (AddressId
           ,[DoorNo]
           ,[City]
           ,[State]
           ,[ZipCode]
           ,[Country]
           ,[IsDeleted]
           ,[CreateDateTime]
           ,[UpdateDateTime]
           ,[CreateUserId]
           ,[UpdateUserId]
           ,[InternalDataId])
     VALUES
           (1
		   ,'390, Free mont street'
           ,'Hyderabad'
           ,'Telangana'
           ,505209
           ,'India'
           ,0
           ,GETDATE()
           ,GETDATE()
           ,1
           ,1
           ,NEWID()
		   )
SET IDENTITY_INSERT [Address] OFF






SET IDENTITY_INSERT [dbo].[ConfigurationSettingTemplate] ON
INSERT [dbo].[ConfigurationSettingTemplate] ([ConfigurationSettingTemplateId],[SettingName],[Value],[IsActive]) 
VALUES(1,N'ConnectionString',N'data source=.;initial catalog=QuickMart;Integrated Security=true;',1),
(2,N'SMTPServer',N'smtp.gmail.com',1),
(3,N'Port',N'587',1),
(4,N'UserName',N'harireddydear@gmail.com',1),
(5,N'Password',N'pp.buzops.com',1),
(6,N'HostName',N'pp.buzops.com',1);
SET IDENTITY_INSERT [dbo].[ConfigurationSettingTemplate] OFF
GO








INSERT INTO ConfigurationSettings (BranchId,IsActive,SettingName,Value)
SELECT
	1,
	1,
	[SettingName],
	[Value]
FROM 
[ConfigurationSettingTemplate]
GO

GO
PRINT N'Update complete.';


GO
